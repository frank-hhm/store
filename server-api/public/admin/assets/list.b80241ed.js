import{_ as re}from"./LayoutBodyTabs.5d3b3186.js";import{a4 as Y,a7 as c,aP as Z,a6 as _e,ac as pe,aQ as fe,aR as ve,ab as be,ag as H,aa as X,aS as ge,ah as Ce,aT as K,aU as xe,aM as J,aj as T,ap as e,aq as l,al as Fe,aV as Ve,aW as he,as as ee,at as Q,aA as g,aN as D,ak as E,aB as b,am as Ee,aJ as le,aX as ye,ao as B,aY as Be,aZ as De,a_ as Ae,aC as ke,a$ as Me,b0 as Re,b1 as Ue,aw as we,a9 as Ie,b2 as Se,b3 as $e,b4 as Te,b5 as Le,an as V,b6 as Ne,b7 as je,b8 as ze,b9 as Oe,ba as qe}from"./index.06ac279d.js";/* empty css               */const Pe={name:"menusCreateComponent"},Ge=Y({...Pe,emits:["success"],setup(ae,{expose:L,emit:A}){const{proxy:p,proxy:{$utils:y}}=Q(),m=c("60px"),R=c(Z().getEnumItem("StatusEnum")),f=c("create"),C=c(0),v=c(!1),N=c(),a=c({module:1,type:1,menu_name:"",pid:null,menu_path:"",menu_node:"",params:"",icon:"",sort:0,status:1,api_rule:""}),j=()=>{O(),C.value&&(d.value=!0,De({id:C.value}).then(t=>{a.value.type=t.data.type,a.value.menu_name=t.data.menu_name,a.value.pid=t.data.pid,a.value.menu_path=t.data.menu_path,a.value.menu_node=t.data.menu_node,a.value.params=t.data.params,a.value.icon=t.data.icon,a.value.sort=t.data.sort,a.value.status=t.data.status.value,a.value.api_rule=t.data.api_rule,d.value=!1}).catch(t=>{y.errorMsg(t)}))},z=_e({menu_name:[{required:!0,message:"\u83DC\u5355\u540D\u79F0\u4E0D\u80FD\u4E3A\u7A7A\uFF01"}]}),d=c(!1),o=A,i=c(!1),x=()=>{var t;(t=p==null?void 0:p.$refs.createRef)==null||t.validate((u,h)=>{if(!u){if(i.value)return;i.value=!0;let r=null;f.value=="create"?r=Ve(a.value):r=he(Object.assign({id:C.value},a.value)),r.then(_=>{y.successMsg(_.message),F(),o("success"),i.value=!1}).catch(_=>{y.errorMsg(_),i.value=!1})}})},U=c([]),O=()=>{let t={};C.value&&(t.pid=C.value),Ae(t).then(u=>{U.value=u.data.menuList}).catch(u=>{y.errorMsg(u)})},q=t=>{},w=c(),I=c(),P=t=>{a.value.api_rule=t.rule},k=t=>{a.value.icon=t},s=(t=0,u)=>{t!=0?(f.value="update",C.value=t):f.value="create",u!="all"&&(a.value.module=u),ee(()=>{j()}),v.value=!0},F=()=>{var t;return(t=p==null?void 0:p.$refs.createRef)==null||t.resetFields(),C.value=0,v.value=!1,!0};return L({open:s}),(t,u)=>{const h=pe,r=ke,_=Me,S=fe,G=Re,ue=ve,te=be,$=H,ne=X("select-icon-modal"),M=Ue,oe=ge,se=Ce,de=K,ie=X("select-rule-modal"),ce=xe,me=J("loading"),W=J("btn");return g(),T("div",null,[e(ce,{title:f.value=="create"?"\u6DFB\u52A0\u83DC\u5355":"\u7F16\u8F91\u83DC\u5355",onBeforeOk:x,onBeforeCancel:F,width:"900px",top:Fe(Be)().ModalTop,class:"modal",visible:v.value,"onUpdate:visible":u[13]||(u[13]=n=>v.value=n),"align-center":!1,"title-align":"start","render-to-body":""},{footer:l(()=>[e(de,null,{default:l(()=>[D((g(),E($,{onClick:F},{default:l(()=>[b("\u53D6\u6D88")]),_:1})),[[W]]),D((g(),E($,{type:"primary",loading:d.value,onClick:x},{default:l(()=>[b("\u786E\u5B9A")]),_:1},8,["loading"])),[[W]])]),_:1})]),default:l(()=>[D((g(),E(se,{model:a.value,ref_key:"createRef",ref:N,rules:z},{default:l(()=>[e(M,{gutter:20},{default:l(()=>[e(_,{md:24,xs:24},{default:l(()=>[e(r,{"label-col-flex":m.value,label:"\u83DC\u5355\u540D\u79F0",field:"menu_name"},{default:l(()=>[e(h,{modelValue:a.value.menu_name,"onUpdate:modelValue":u[0]||(u[0]=n=>a.value.menu_name=n),placeholder:"\u8BF7\u8F93\u5165\u83DC\u5355\u540D\u79F0"},null,8,["modelValue"])]),_:1},8,["label-col-flex"])]),_:1}),e(_,{md:24,xs:24},{default:l(()=>[e(r,{"label-col-flex":m.value,label:"\u6A21\u5757",field:"module"},{default:l(()=>[e(G,{modelValue:a.value.module,"onUpdate:modelValue":u[1]||(u[1]=n=>a.value.module=n)},{default:l(()=>[e(S,{value:1},{default:l(()=>[b("\u7CFB\u7EDF")]),_:1})]),_:1},8,["modelValue"])]),_:1},8,["label-col-flex"])]),_:1}),e(_,{md:24,xs:24},{default:l(()=>[e(r,{"label-col-flex":m.value,label:"\u7C7B\u578B",field:"type"},{default:l(()=>[e(G,{modelValue:a.value.type,"onUpdate:modelValue":u[2]||(u[2]=n=>a.value.type=n)},{default:l(()=>[e(S,{value:1},{default:l(()=>[b("\u83DC\u5355")]),_:1}),e(S,{value:2},{default:l(()=>[b("\u4E8B\u4EF6")]),_:1})]),_:1},8,["modelValue"])]),_:1},8,["label-col-flex"])]),_:1}),e(_,{md:12,xs:24},{default:l(()=>[e(r,{"label-col-flex":m.value,label:"\u7236\u7EA7\u5206\u7C7B",field:"pid"},{default:l(()=>[e(ue,{modelValue:a.value.pid,"onUpdate:modelValue":u[3]||(u[3]=n=>a.value.pid=n),options:U.value,onChange:q,"allow-search":"","allow-clear":"",class:"form-select-fil","check-strictly":"",placeholder:"\u8BF7\u9009\u62E9\u7236\u7EA7\u5206\u7C7B"},null,8,["modelValue","options"])]),_:1},8,["label-col-flex"])]),_:1}),e(_,{md:12,xs:24},{default:l(()=>[e(r,{"label-col-flex":m.value,label:"\u56FE\u6807",field:"icon",class:"default-append"},{default:l(()=>[e(h,{modelValue:a.value.icon,"onUpdate:modelValue":u[5]||(u[5]=n=>a.value.icon=n),placeholder:"\u9009\u62E9\u56FE\u6807"},{prefix:l(()=>[e(te)]),append:l(()=>[e($,{onClick:u[4]||(u[4]=()=>{I.value.open()})},{default:l(()=>[b(" \u56FE\u6807 ")]),_:1}),e(ne,{ref_key:"selectModalIconRef",ref:I,onChange:k},null,512)]),_:1},8,["modelValue"])]),_:1},8,["label-col-flex"])]),_:1})]),_:1}),e(M,{gutter:20},{default:l(()=>[a.value.type!=3?(g(),E(_,{key:0,md:12,xs:24},{default:l(()=>[e(r,{"label-col-flex":m.value,label:"\u8DEF\u7531\u5730\u5740",field:"menu_path"},{default:l(()=>[e(h,{modelValue:a.value.menu_path,"onUpdate:modelValue":u[6]||(u[6]=n=>a.value.menu_path=n),placeholder:"\u8BF7\u8F93\u5165\u8DEF\u7531\u5730\u5740"},null,8,["modelValue"])]),_:1},8,["label-col-flex"])]),_:1})):Ee("",!0),e(_,{md:12,xs:24},{default:l(()=>[e(r,{"label-col-flex":m.value,label:"\u63A5\u53E3",field:"api_rule",class:"default-append"},{default:l(()=>[e(h,{disabled:"",modelValue:a.value.api_rule,"onUpdate:modelValue":u[8]||(u[8]=n=>a.value.api_rule=n),placeholder:"\u8BF7\u9009\u62E9\u63A5\u53E3"},{append:l(()=>[e($,{onClick:u[7]||(u[7]=()=>{w.value.open()})},{default:l(()=>[b(" \u63A5\u53E3 ")]),_:1})]),_:1},8,["modelValue"])]),_:1},8,["label-col-flex"])]),_:1}),e(_,{md:12,xs:24},{default:l(()=>[e(r,{"label-col-flex":m.value,label:"\u6743\u9650\u6807\u8BC6",field:"menu_node"},{default:l(()=>[e(h,{modelValue:a.value.menu_node,"onUpdate:modelValue":u[9]||(u[9]=n=>a.value.menu_node=n),placeholder:"\u8BF7\u8F93\u5165\u6743\u9650\u6807\u8BC6"},null,8,["modelValue"])]),_:1},8,["label-col-flex"])]),_:1})]),_:1}),e(M,{gutter:20},{default:l(()=>[e(_,{md:24,xs:24},{default:l(()=>[e(r,{"label-col-flex":m.value,label:"\u53C2\u6570",field:"params"},{default:l(()=>[e(h,{modelValue:a.value.params,"onUpdate:modelValue":u[10]||(u[10]=n=>a.value.params=n)},null,8,["modelValue"])]),_:1},8,["label-col-flex"])]),_:1})]),_:1}),e(M,{gutter:20},{default:l(()=>[e(_,{md:12,xs:24},{default:l(()=>[e(r,{"label-col-flex":m.value,label:"\u6392\u5E8F\uFF1A",field:"sort"},{default:l(()=>[e(oe,{modelValue:a.value.sort,"onUpdate:modelValue":u[11]||(u[11]=n=>a.value.sort=n),min:0,max:1e4},null,8,["modelValue"])]),_:1},8,["label-col-flex"])]),_:1})]),_:1}),e(M,{gutter:20},{default:l(()=>[e(_,{md:12,xs:24},{default:l(()=>[e(r,{"label-col-flex":m.value,label:"\u72B6\u6001",field:"status"},{default:l(()=>[e(G,{modelValue:a.value.status,"onUpdate:modelValue":u[12]||(u[12]=n=>a.value.status=n)},{default:l(()=>[(g(!0),T(le,null,ye(R.value,n=>(g(),E(S,{value:n.value,key:n.value},{default:l(()=>[b(B(n.name),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["label-col-flex"])]),_:1})]),_:1})]),_:1},8,["model","rules"])),[[me,d.value]]),e(ie,{ref_key:"selectRuleRef",ref:w,onChange:P},null,512)]),_:1},8,["title","top","visible"])])}}}),Je=V("div",{class:"mt20"},null,-1),Qe={class:"m20"},We={class:"text-grey"},Xe={class:"text-grey"},Ye={class:"text-grey"},Ze={class:"text-grey"},ll=Y({__name:"list",setup(ae){const L=we(),{proxy:A}=Q(),{proxy:{$utils:p}}=Q(),y=c(),m=c(!0),R=c([]),f=(d=!1)=>{m.value=!0;let o={};v.value!=""&&(o.module=v.value),Ne(o).then(i=>{R.value=i.data.list,d&&L.setMenus(i.data.menusList),setTimeout(()=>{m.value=!1},300)}).catch(i=>{p.errorMsg(i)})},C=c([{name:"\u5168\u90E8",value:"all"},{name:"\u7CFB\u7EDF",value:"1"}]);Ie(()=>{ee(()=>{let d=Z().getEnumItem("AppsTypeEnum");for(let o in d)C.value.push(d[o])}),f()});const v=c("all"),N=d=>{v.value=d,f()},a=d=>{var o;(o=A==null?void 0:A.$refs.createComponentRef)==null||o.open(d,v.value)},j=(d,o)=>{o.switch===!0&&(o.loading=!0,m.value=!0,ze({id:o.id,status:d}).then(i=>{o.loading=!1,f(!0),p.successMsg(i)}).catch(i=>{o.loading=!1,f(),p.errorMsg(i)}))},z=d=>{Oe({id:d}).then(o=>{f(!0),p.successMsg(o.message)}).catch(o=>{p.errorMsg(o)})};return(d,o)=>{const i=H,x=qe,U=Se,O=$e,q=Te,w=K,I=Le,P=re,k=J("permission");return g(),T(le,null,[V("div",null,[D((g(),E(i,{type:"primary",onClick:o[0]||(o[0]=s=>a(0))},{default:l(()=>[b(" \u6DFB\u52A0\u83DC\u5355 ")]),_:1})),[[k,"system-menus-create"]]),e(Ge,{ref_key:"createComponentRef",ref:y,onSuccess:o[1]||(o[1]=s=>f(!0))},null,512)]),Je,e(P,{tabs:C.value,modelValue:v.value,"onUpdate:modelValue":o[2]||(o[2]=s=>v.value=s),onChange:N},{default:l(()=>[V("div",Qe,[e(I,{loading:m.value,data:R.value,"row-key":"id",isLeaf:"",pagination:!1,bordered:!1},{columns:l(()=>[e(x,{title:"\u83DC\u5355\u540D\u79F0","data-index":"menu_name",width:400},{cell:l(({record:s})=>[V("span",We,B(s.html),1),V("span",null,B(s.menu_name),1)]),_:1}),e(x,{title:"\u56FE\u6807","data-index":"icon",width:80},{cell:l(({record:s})=>[V("span",{class:je(["icon",s.icon])},null,2)]),_:1}),e(x,{title:"\u8DEF\u7531\u5730\u5740","data-index":"menu_path",width:160},{cell:l(({record:s})=>[V("span",Xe,B(s.menu_path),1)]),_:1}),e(x,{title:"Api\u63A5\u53E3","data-index":"api_rule",width:160},{cell:l(({record:s})=>[V("span",Ye,B(s.api_rule),1)]),_:1}),e(x,{title:"\u6743\u9650\u6807\u8BC6","data-index":"menu_node",width:160},{cell:l(({record:s})=>[V("span",Ze,B(s.menu_node),1)]),_:1}),e(x,{title:"\u72B6\u6001",fixed:"right","data-index":"status",align:"center",width:80},{cell:l(({record:s})=>[e(U,{modelValue:s.status.value,"onUpdate:modelValue":F=>s.status.value=F,size:"small",type:"round",loading:s.loading,beforeChange:()=>s.switch=!0,onChange:F=>j(F,s),"checked-value":1,"unchecked-value":0},null,8,["modelValue","onUpdate:modelValue","loading","beforeChange","onChange"])]),_:1}),e(x,{title:"\u64CD\u4F5C",fixed:"right",align:"center",width:140},{cell:l(({record:s})=>[e(w,null,{default:l(()=>[D((g(),E(i,{hoverable:!1,onClick:F=>a(s.id),size:"small"},{default:l(()=>[b("\u7F16\u8F91")]),_:2},1032,["onClick"])),[[k,"system-menus-update"]]),D((g(),T("div",null,[e(q,{content:"\u786E\u5B9A\u5220\u9664\u5417\uFF1F",onConfirm:F=>z(s.id)},{icon:l(()=>[e(O,{type:"red"})]),default:l(()=>[e(i,{size:"small"},{default:l(()=>[b("\u5220\u9664")]),_:1})]),_:2},1032,["onConfirm"])])),[[k,"system-menus-delete"]])]),_:2},1024)]),_:1})]),_:1},8,["loading","data"])])]),_:1},8,["tabs","modelValue"])],64)}}});export{ll as default};
